---
lab:
  title: تحليل النماذج باستخدام نماذج التحليل الذكي للمستندات المخصصة من الذكاء الاصطناعي في Azure
  description: إنشاء نموذج Document Intelligence مخصص لاستخراج بيانات معيّنة من المستندات.
---

# تحليل النماذج باستخدام نماذج التحليل الذكي للمستندات المخصصة من الذكاء الاصطناعي في Azure

نفترض أن الشركة تتطلب حاليًا من الموظفين شراء أوراق الطلبات يدويًا وإدخال البيانات في قاعدة البيانات. يريدون منك استخدام خدمات الذكاء الاصطناعي لتحسين عملية إدخال البيانات. قررت إنشاء نموذج تعلُّم آلي يقرأ النموذج وينتج بيانات منظمة يمكن استخدامها لتحديث قاعدة البيانات تلقائيًا.

تُعدَّ **Azure AI Document Intelligence** خدمة الذكاء الاصطناعي في Azure التي تُمكِّن المستخدمين من إنشاء برامج معالجة البيانات الآلية. يمكن لهذا البرنامج استخراج النصوص وأزواج المفاتيح/القيم والجداول من مستندات النماذج باستخدام التعرُّف البصري على الحروف (OCR). يحتوي Azure AI Document Intelligence على نماذج جاهزة مسبقًا للتعرُّف على الفواتير والإيصالات وبطاقات العمل. وتوفر الخدمة أيضًا القدرة على تدريب النماذج المخصَّصة. في هذا التمرين، سنركز على تصميم نماذج مخصَّصة.

على الرغم من أن هذا التمرين يستند إلى Python، يمكنك تطوير تطبيقات مماثلة باستخدام حزم SDK مخصصة للغات برمجة متعددة، منها:

- [مكتبة عميل Azure AI Document Intelligence لـ Python](https://pypi.org/project/azure-ai-formrecognizer/)
- [مكتبة عميل Azure AI Document Intelligence لـ Microsoft .NET](https://www.nuget.org/packages/Azure.AI.FormRecognizer)
- [مكتبة عميل Azure AI Document Intelligence لـ JavaScript](https://www.npmjs.com/package/@azure/ai-form-recognizer)

سيستغرق هذا التدريب حوالي **30** دقيقة.

## إنشاء مورد Azure AI Document Intelligence

لاستخدام خدمة Azure AI Document Intelligence، تحتاج إلى مورد Azure AI Document Intelligence أو Azure AI Services في اشتراك Azure الخاص بك. ستستخدم مدخل Microsoft Azure لإنشاء مورد.

1. في علامة تبويب المستعرض، افتح مدخل Microsoft Azure على `https://portal.azure.com`، وقم بتسجيل الدخول باستخدام حساب Microsoft المرتبط باشتراكك في Azure.
1. في الصفحة الرئيسية لمدخل Microsoft Azure، انتقل إلى مربع البحث العلوي واكتب **Document Intelligence**، ثم اضغط على **إدخال**.
1. في صفحة **Document Intelligence**، حدد **إنشاء**.
1. في صفحة **إنشاء Document Intelligence**، أنشئ موردًا جديدًا بالإعدادات التالية:
    - **Subscription**: حدد اشتراك Azure الخاص بك.
    - **مجموعة الموارد**: أنشئ أو حدد مجموعة موارد
    - **المنطقة**: أي منطقة متاحة
    - **الاسم**: اسم صالح لمورد Document Intelligence
    - **مستوى الأسعار**: الخطة المجانبة F0 (*إذا لم تكن الخطة المجانية متاحة، فحدّد *الخطة القياسية S0).
1. عند اكتمال النشر، حدد **الانتقال إلى المورد** لعرض صفحة **نظرة عامة** الخاصة بالمورد.

## الإعداد لتطوير تطبيق في Cloud Shell

ستقوم بتطوير تطبيق الترجمة النصية باستخدام Cloud Shell. تم توفير ملفات التعليمات البرمجية لتطبيقك في GitHub repo.

1. في بوابة Azure، استخدم الزر **[\>_]** على يمين شريط البحث أعلى الصفحة لإنشاء Cloud Shell جديد في بوابة Azure، وتحديد بيئة ***PowerShell***. يوفّر Cloud Shell واجهة سطر أوامر في جزء أسفل بوابة Azure.

    > **ملاحظة**: إذا كنت قد أنشأت مسبقًا Cloud Shell يستخدم بيئة *معالج Bash*، فبدّل إلى ***PowerShell***.

1. عدِّل حجم جزء Cloud Shell بحيث تتمكن من عرض كلٍ من وحدة سطر الأوامر ومدخل Microsoft Azure. ستحتاج إلى استخدام شريط الانقسام عند التنقل بين الجزأين.

1. في شريط أدوات Cloud Shell، في قائمة **الإعدادات**، حدد **الانتقال إلى الإصدار الكلاسيكي** (هذا مطلوب لاستخدام محرر التعليمات البرمجية).

    **<font color="red">تأكد من التبديل إلى الإصدار الكلاسيكي من cloud shell قبل المتابعة.</font>**

1. في جزء PowerShell، أدخل الأوامر التالية لاستنساخ مستودع GitHub لهذا التمرين:

    ```
   rm -r mslearn-ai-info -f
   git clone https://github.com/microsoftlearning/mslearn-ai-information-extraction mslearn-ai-info
    ```

    > **تلميح**: عند لصق الأوامر في CloudShell، قد يشغل الإخراج مساحة كبيرة من ذاكرة التخزين المؤقت للشاشة. يمكنك مسح الشاشة عن طريق إدخال الأمر `cls` لتسهيل التركيز على كل مهمة.

1. بعد استنساخ مخزن بيانات خاصة، انتقل إلى المجلد الذي يحتوي على ملفات التعليمات البرمجية لتطبيق الدردشة:  

    ```
   cd mslearn-ai-info/Labfiles/custom-doc-intelligence
    ```

## جمع المستندات للتدريب

ستستخدم نماذج العينة مثل هذا النموذج لتدريب نموذج اختبار: 

![صورة الفاتورة المستخدمة في هذا المشروع.](./media/Form_1.jpg)

1. في سطر الأوامر، قم بتشغيل `ls ./sample-forms` لعرض محتوى المجلد **sample-forms**. لاحظ أن هناك ملفات تنتهي بـ **.json** و **.jpg** في المجلد.

    ستستخدم ملفات **.jpg** لتدريب نموذجك.  

    لقد تم إنشاء ملفات **.json** لك وهي تحتوي على معلومات التسمية. سيتم تحميل الملفات إلى حاوية تخزين الكائنات الثنائية كبيرة الحجم الخاصة بك إلى جانب النماذج.

1. في **مدخل Microsoft Azure**، انتقل إلى صفحة **نظرة عامة** الخاصة بموردك إذا لم تكن هناك بالفعل. ضمن قسم *Essentials*، اطّلع على **مجموعة الموارد** و**معرّف الاشتراك** و**الموقع**. ستحتاج إلى هذه القيم في الخطوات التالية.
1. قم بتشغيل الأمر `code setup.sh` لفتح **setup.sh** في محرر التعليمات البرمجية. ستستخدم هذا البرنامج النصي لتشغيل أوامر واجهة سطر أوامر Azure (CLI) المطلوبة لإنشاء موارد Azure الأخرى التي تحتاجها.

1. في البرنامج النصي **setup.cmd**، راجع الأوامر. سيقوم البرنامج بما يلي:
    - إنشاء حساب تخزين في مجموعة موارد Azure الخاصة بك
    - تحميل الملفات من مجلد *sampleforms* المحلي الخاص بك إلى حاوية تسمى *sampleforms* في حساب التخزين
    - طباعة معرف URI لـ Shared Access Signature

1. قم بتعديل إعلانات المتغيرات **subscription_id**، و**resource_group**، و**location** بالقيم المناسبة للاشتراك ومجموعة الموارد واسم الموقع الذي قمت بنشر مورد Document Intelligence فيه.

    > **مهم**: بالنسبة لسلسلة **الموقع**، تأكد من استخدام إصدار التعليمات البرمجية لموقعك. على سبيل المثال، إذا كان موقعك هو "شرق الولايات المتحدة"، فيجب أن تكون السلسلة النصية في البرنامج النصي هي `eastus`. يمكنك عرض هذا الإصدار من خلال النقر على زر **عرض JSON** على الجانب الأيسر من علامة تبويب **الأساسيات** الخاصة بمجموعة الموارد في مدخل Microsoft Azure.

    إذا كانت قيمة المتغير **expiry_date** تشير إلى تاريخ سابق، فقم بتحديثها إلى تاريخ مستقبلي. يتم استخدام هذا المتغير عند إنشاء معرف URI لـ Shared Access Signature (SAS). في الممارسة العملية، قد ترغب في تحديد تاريخ انتهاء صلاحية مناسب لـ SAS الخاص بك. يمكنك معرفة المزيد عن SAS [هنا](https://docs.microsoft.com/azure/storage/common/storage-sas-overview#how-a-shared-access-signature-works).  

1. بعد استبدال العناصر النائبة، استخدم الأمر **CTRL+S** أو **Right-click > Save** لحفظ التغييرات ثم استخدم الأمر **CTRL+Q** أو **Right-click > Quit** لإغلاق محرر التعليمات البرمجية مع إبقاء سطر أوامر Cloud Shell مفتوحًا.

1. أدخِل الأوامر التالية لجعل البرنامج النصي قابلًا للتنفيذ ولتشغيله:

    ```PowerShell
   chmod +x ./setup.sh
   ./setup.sh
    ```

1. عند اكتمال البرنامج النصي، قم بمراجعة المخرجات المعروضة.

1. في مدخل Microsoft Azure، قم بتحديث مجموعة الموارد الخاصة بك وتأكد من أنها تحتوي على حساب Azure Storage الذي تم إنشاؤه للتو. افتح حساب التخزين، وفي الجزء الموجود على اليسار، حدد **متصفح التخزين**. بعد ذلك في متصفح التخزين، قم بتوسيع **حاويات Blob** ثم حدّد الحاوية **sampleforms** للتحقق من تحميل الملفات من المجلد المحلي **custom-doc-intelligence/sample-forms**.

## تدريب النموذج باستخدام Document Intelligence Studio

سنقوم الآن بتدريب النموذج باستخدام الملفات التي قمت بتحميلها إلى حساب التخزين.

1. افتح علامة تبويب متصفح جديدة، وانتقل إلى Document Intelligence Studio عبر الرابط التالي `https://documentintelligence.ai.azure.com/studio`. 
1. مرِّر لأسفل إلى قسم **النماذج المخصَّصة** وحدد تجانب **نموذج الاستخراج المخصَّص**.
1. إذا طُلب منك ذلك، فسجّل دخول باستخدام بيانات اعتماد Azure الخاصة بك.
1. إذا تم سؤالك عن مورد Azure AI Document Intelligence الذي يجب استخدامه، فحدد الاشتراك واسم المورد اللذين استخدمتهما عند إنشاء مورد Azure AI Document Intelligence.
1. ضمن **مشاريعي**، أنشئ مشروعًا جديدًا باستخدام التكوين التالي:

    - **أدخِل تفاصيل المشروع**:
        - **اسم المشروع**: اسم صالح لمشروعك
    - **تكوين مورد الخدمة**:
        - **اشتراك**: اشتراكك في Azure
        - **مجموعة الموارد**: مجموعة الموارد التي نشرت فيها مورد Document Intelligence
        - **مورد Document intelligence** مورد Document Intelligence الخاص بك (حدّد الخيار *تعيين كخيار افتراضي* واستخدم إصدار واجهة برمجة التطبيقات الافتراضي)
    - **ربط مصدر بيانات التدريب**:
        - **اشتراك**: اشتراكك في Azure
        - **مجموعة الموارد**: مجموعة الموارد التي نشرت فيها مورد Document Intelligence
        - **حساب التخزين**: حساب التخزين الذي أنشأه البرنامج النصي للإعداد (حدّد الخيار *تعيين كخيار افتراضي*، وحدّد حاوية Blob`sampleforms`، واترك مسار المجلد فارغًا)

1. بمجرد إنشاء مشروعك، انقر على **تدريب** في أعلى يسار الصفحة لتدريب النموذج الخاص بك. استخدم التكوينات التالية:
    - **معرف النموذج**: اسم صالح لنموذجك (*ستحتاج إلى اسم معرّف النموذج في الخطوة التالية *)
    - **وضع الإصدار**: القالب.
1. حدد **الانتقال إلى النماذج**.
1. قد يستغرق التدريب بعض الوقت. انتظر حتى تصبح الحالة **ناجحة**.

## اختبار نموذج Document Intelligence المخصَّص الخاص بك

1. ارجع إلى علامة تبويب المتصفح التي تحتوي على مدخل Microsoft Azure وCloud Shell. في سطر الأوامر، شغّل الأمر التالي للتغيير إلى المجلد الذي يحتوي على ملفات التعليمات البرمجية للتطبيق:

    ```
    cd Python
    ```

1. قم بتثبيت حزمة Document Intelligence عن طريق تشغيل الأمر التالي:

    ```
    python -m venv labenv
   ./labenv/bin/Activate.ps1
   pip install -r requirements.txt azure-ai-formrecognizer==3.3.3
    ```

1. أدخل الأمر التالي لتحرير ملف التكوين الذي تم توفيره:

    ```
   code .env
    ```

1. في الجزء الذي يحتوي على مدخل Microsoft Azure، في صفحة **نظرة عامة** لمورد Document Intelligence، حدّد **انقر هنا لإدارة المفاتيح** لعرض نقطة النهاية والمفاتيح الخاصة بموردك. ثمّ حرّر ملف التكوين باستخدام القيم التالية:
    - نقطة نهاية Document Intelligence الخاصة بك
    - مفتاح Document Intelligence الخاص بك
    - معرّف النموذج الذي حددته عند تدريب نموذجك

1. بعد استبدال العناصر النائبة في محرر التعليمات البرمجية، استخدم الأمر **CTRL+S** لحفظ التغييرات ثم استخدم الأمر **CTRL+Q** لإغلاق محرر التعليمات البرمجية مع إبقاء سطر أوامر Cloud Shell مفتوحًا.

1. افتح ملف التعليمات البرمجية لتطبيق العميل الخاص بك (سواءً `code Program.cs` لـ C#‎ أو`code test-model.py` لـ Python) وراجع ما يحتويه من تعليمات برمجية، لا سيما أن الصورة في عنوان URL تشير إلى ملف موجود في مستودع GitHub على الويب. أغلِق الملف دون إجراء أي تغييرات.

1. في سطر الأوامر، أدخِل الأمر التالي لتشغيل البرنامج:

    ```
   python test-model.py
    ```

1. قم بعرض المخرجات ولاحظ كيف يوفر مخرج النموذج أسماء الحقول مثل `Merchant` و`CompanyPhoneNumber`.

## تنظيف

إذا انتهيت من استخدام مورد Azure، فتذكر حذف المورد في [مدخل Microsoft Azure](https://portal.azure.com/?azure-portal=true) لتجنب المزيد من الرسوم.

## مزيد من المعلومات

لمزيد من المعلومات حول خدمة Document Intelligence، راجع [مستندات Document Intelligence](https://learn.microsoft.com/azure/ai-services/document-intelligence/?azure-portal=true).
